<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<link href="styles.css" rel="stylesheet" type="text/css" />
<link rel="shortcut icon" href="../icon.png" type="image/png" />
<title>Render Farm Managers Troubles</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="CGRU: CG Tools, CG Rules, Afanasy - Free Open Source Render Farm Manager" />
<meta name="keywords" content="Houdini, Maya, Nuke, RenderMan, Mantra, Mentalray, Max, XSI, SoftImage, prman, Afanasy, animation, rendering, render, farm, manager, free, open source, 3D, 2D" />
</head>
<body>

<table width="90%" border="0" align="center" cellpadding="0" cellspacing="0"><tr><td>
<!--HEADER-->

<h2 align="center">Возможные проблемы сетевого просчёта.</h2>
<hr />

<table width="1000" height="440" bgcolor="#404040" align="center">
<tr><td align="center"><img src="images/shashlik.jpg" align="middle" alt="shashlik"/>
</td></tr></table>

<p>
Все диспетчеры только запускают командную строку на удалённом компьютере. Но пользователи нередко наделяют возможностями рабочей программы и сам диспетчер. Не раз слышал вопросы типа - а может ли он считать в EXR, а может ли бейкать оклюжн и т.п. Диспетчер запустит Maya на удалённом компьютере, со сценой которую настроили Вы, и что уж она сделает или умеет делать, ему по барабану.
</p>
<p>
Бывает так что получается разный результат когда вы в открытой вами рабочей программе нажимаете на кнопку "рендер" и когда вы посылаете считаться на ферме. Часто в этом винят программу диспетчер - "почему она считает по-другому". А попробуйте сами запустить ту командну, которую запускает диспетчер. Обычно тут всё и выясняется. Ошибки же диспетчера существуют, но они другого характера. Например перестал отвечать клиент, приходит неправильная информация о его ресурсах, просто завис клиент или сервер. Но неправильно посчитать он не может в принципе, так он ничего не считает, а просто запускает ваши же рабочие программы с вашими же сценами на других компьютерах.
</p>
<p>
Диспетчер может только запустить неправильную команду. Тогда надо выяснять кто её подал диспетчеру.
</p>
<ul>
   <li><i>Вы сами писали эти команды "ручками" и отправляли диспетчеру.</i><br/>
      Тут понятно, кто накосячил.
   </li>
   <li><i>Вы послали считаться сцену используя для этого готовые инструменты ("менюшки", "окошки").</i><br/>
      <ul>
         <li><i>У вас есть технической директор.</i><br/>
            Жалуйтесь.
            Может он сам прикручивал диспетчер к вашей рабочей программе.
            Или подправил сущесвующие инструменты.
            Тогда он виноват.
            Или он будет общаться с разработчиками. Или даже править их баг.
            Теперь в любом случае это его проблема.
         </li>
         <li><i>У вас нет технического директора.</i><br/>
            Если вы сами ничего не меняли в диспетчере (то есть если вы сами не ТД),
            значит вы пользуетесь инструментами, предоставляемыми разработчиками диспетчера.
            Тогда в диспетчере баг.
            Это значит он не работает у всех пользователей во всех конторах, и у разработчиков тоже.
            Это скорее всего уже заметили, и возможно исправили.
         </li>
      </ul>
   </li>
</ul>
<p>
Хочу ещё обратить ваше внимание на то, что есть задачи которые нельзя разделить на кадры и каждый считать по отдельности. Это задачи, где каждый следующий кадр зависит от предыдущего. Сюда попадают всевозможные симуляции: партиклы, одежда, волосы, мех, флюиды. Что произойдет если вы сразу переместитесь в какой-нибудь 200 кадр, зависит от приложения. Симуляции либо не произойдёт вовсе, либо она будет считаться с начала на каждом компьютере, тогда смысла нет её считать на ферме. Перед расчётом картинки на ферме симуляцию обычно бейкают на одном компьютере.
</p>
<p>
Надо как-то узнать какую конкретно команду диспетчер просит запустить клиента. Наверняка это можно сделать в любом диспетчере, иначе будут большие трудности с его тестированием и настройкой.<br/>
(в Афанасии откройте задачу и кликните мышкой на "таск", внизу а линии "статуса" она появится, от туда её можно скопировать, рабочий каталог можно посмотреть свойствах "блока")
</p>
<p>
Этот "troubleshooting" запуска команды. Поэтому можно сказать что это "troubleshooting" любого диспетчера.
</p>
<ul>
   <li><i>Запустите эту командную строку на своём компьютере.</i><br/>
      <ul>
         <li><i>Не запускается.</i><br/>
            <ol>
               <li>Проблемы с путями.</li>
               <li>
                  Командная строка в любой OS показывает где вы находитесь.
                  Возможно команда должна быть запущена из определённого места, если вы используете относительные пути.
                  Тогда перейдите в ту папку где её запускает диспетчер, и запустите от туда.
               </li>
               <li>
                  Скрипт, создавший задачу, не правильно сгенерил команду.
                  Если вы не сами "ручками" писали команды диспетчеру,
                  а воспользовались готовой для этого утилитой ("менюшкой, окошком"), то команда правильная.
                  Либо это баг в диспетчере и он у всех, обращайтесь к разработчикам.
                  Возможно это ваш ТД прикрутил или просто подправил запускалку.
               </li>
            </ol>
         </li>
         <li><i>Запустилось с ошибками. Результат другой.</i><br/>
            <ol>
               <li>
                  Иногда приложения могут работать немного по разному через с GUI и без него.
                  Например Maya не запускает скрипты связанные с GUI,
                  а может где-то в них вы инициализируете нужную вам процедуру
                  (а ещё как-то в ней генерация mi фалов без GUI немного по-другому работала).
               </li>
            </ol>
         </li>
      </ul>
   </li>
   <li><i>Запустите эту команду на рендере.</i><br/>
      <ul>
      <li><i>Не запускается.</i><br/>
         <ol>
            <li><i>Убедитесь что на рендерах стоят те же программы что и у вас.</i><br/>
               Лучше держать папку со всеми необходимыми программами где-нибудь на сервере.
               Рабочие станции и рендера настроить так чтобы они, например, при загрузке синхронизировались с этой папкой.
               Не надо устанавливать софт, его достаточно просто переписать.
            </li>
         </ol>
      </li>
      <li><i>Запустилось с ошибками. Результат другой.</i><br/>
         <ol>
            <li><i>Рендер имеет доступ до сцены и всех её ресурсов?</i><br/>
               Лучше работать на удалённо на файловом сервере.
               А сеть везде настроить так, чтобы у пользователя и у рендера была та же файловая система.
               Тогда на любом компьютере одни и те же пути в проекте.
            </li>
            <li><i>Убедитесь что на рендерах стоят те же утилиты, скрипты, плагины что и у вас.</i><br/>
               Всякие мелкие тулзы можно просто держать в общей папке на сервере.
               А программы настроить так, чтобы они не локально что-то искали, а на этом сервере.
               Тогда точно у всех всё будет одинаково.
            </li>
         </ol>
      </li>
      </ul>
   </li>
   <li><i>Зайдите удалённо на рендер пользователем, от имени которого работает там клиент диспетчера.
      И снова запустите команду.</i><br/>
      Под другим пользователем возможно другие пути и прочие переменные. Этот момент надо учитывать.
      Может ещё вы что-то инициализируете во время логина и это работает только "под вами".
   </li>
   <li><i>Это последний рубеж. Далее, действительно можно сказать, что "виноват" диспетчер.</i><br/>
      Как то он по-другому запускает команду, не как вы.
      Но такое бывает очень редко и на очень нестандартных задачах.
      Если вы не сами сгенерили задачу, а воспользовались готовым скриптом из вашего рабочего софта, то это врятли.
      Но всё же. Узнайте как диспетчер запускает командную строку.
      Например Афанасий в Linux и Mac "bash -c командна_с_аргументами", в MS Windows "cmd.exe /c командна_с_аргументами".
      Т.е. запускает определённую оболочку и уже ей подаёт команду.
      Думаю что так делают все диспетчеры.
      <br/>
      (если вы не поняли о чём речь, то вы не должны были дойти до этого пункта, ищите ошибку раньше)
   </li>
</ul>

<p>
</p>

<table width="1000" height="450" bgcolor="#FFFFFF" align="center"><tr>
<td align="center"><img src="images/troubleshooting.gif" align="middle" alt="troubleshooting"/></td>
</tr></table>

<!--FOOTER-->
</td></tr></table>

<table width="99%" align="center">
<tr align="center">
<td width="33%">
</td>
<td width="33%">
<p><a href="../index.html" target="_top">CGRU</a></p>
</td>
<td width="33%">
</td>
</tr>
</table>
</body>
</html>
